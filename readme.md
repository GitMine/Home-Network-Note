🚧 **Under Construction** 🚧

目前家里使用的是省心版本，稍后慢慢更新上来。

## 项目说明

    记录搭建家用兼顾学习和娱乐网络环境的一些事情，以及折腾过的一些硬件的小经验。

### 目的

| 功能 |备份数据|数据交换|无线接入|数据同步|workflow|开发学习|游戏娱乐|
| --- | --- | --- | --- | --- | --- | --- | --- |
| **核心** | 安全 | 高速 | 安全 | 无感知 | 易定制 | 流畅 | 流畅 |
| **重要** | 高效 | 易用 | 简单 | 准确| 省心 | 省心 | 舒适 |
| **可选** | 易用 | 安全 | 快速 | 全平台 | - | 冗余保障 | - |


## 历史设备列表

    如果你考虑入手一些设备(主机/路由/网卡/显示器/储存/移动设备/娱乐/...)，或许可以从这里得到一些参考消息。

[不完整清单](./device-list-history.md) | [屏幕历史状态](./display-history.md)

## 当前屋内常保持联网设备清单（10～20设备可参考）

> 🌈 宽带资源
> 不敢想假如家里没有稳定的网络会怎样

| 资源类型 | 明细 | 备注 |
| --- | --- | --- |
| 北京联通 | 50M | 迅雷快鸟 ^2 提速到100M |
| ~~北京双线~~ ^1 | ~~50M~~ | ~~可以多拨到7~9MB/s的小区宽带~~（因上行太烂而废弃） |

- [1] 简化不必要的多线宽带，避免策略路由带来的各种问题，以及需要使用软路由聚合不同类型宽带。
- [2] 迅雷会员附带功能，还算实用，联通宽带官方客户端似乎也可以进行类似操作，或者寻找一下民间快鸟版本，原理比较简单，向ISP供应商发送变速接口心跳包即可，可集成到路由中，或者使用App。

> ⭐️ 路由网关
> 影响网络质量的核心设备，负责部分网络安全事务

| 资源类型 | 明细 | 网络 | 储存 | 开始服务 |
| --- | --- | --- | --- | --- |
| 交换机 | NETGEAR GS308 ^1 | 千兆LAN x8 | - | 2016 |
| 路由器 | Xiaomi Mini 第一版 ^2 | 2G WIFI / 5G WIFI / 百兆LAN | - | 2015 / 2016 |
| 路由器 | Xiaomi Mini 青春版 ^3 | 2G WIFI / 百兆LAN | - | 2016 |
| 路由器 | newifi D2 ^4 | 2G WIFI / 5G WIFI / 千兆LAN | 8G | 2016 |

- [1] 八口千兆交换机，自带铁壳散热，目前感觉最超值的一个设备。
- [2] 硬伤是全部百兆LAN口，不适合200M宽带入户的情况。刷机之后十分稳定，家用设备多可做主路由来拨号使用，家用设备少，不存在什么问题，已入三台。
- [3] 功耗极低，小巧方便，适合旅游或者临时需要网络进行调试的场景，三方适配的固件功能强大，已入三台，如果公司不限制使用自建路由作为调试环境，强烈建议入一台。
- [4] 功耗相比较它的性能来说尚可，大内存业界良心，作为二级路由，可以做到半年以上不重启，三方适配的固件功能十分强大。


> 💻 主机资源
> 提供运算能力的设备

| 资源类型 | 明细 | 网络 | 储存 | 开始服务 |
| --- | --- | --- | --- | --- |
| 公司机器 | MacBook Pro ^1 | 千兆LAN / 5G WIFI | 16GBRAM / 251GB  | 2017 |
| 编码机器 | MacBook Pro ^2 | 千兆LAN & 5G WIFI | 16GBRAM / 500GB  | 2014 |
| 资源机器 | HASEE Z7    ^3 | 千兆LAN & 5G WIFI | 32GBRAM / mixed  | 2015 |
| 功能机器 | N3700组装机  ^4 | 千兆LANx4 & 5G WIFI | 16GBRAM / mixed | 2016 |
| 临时机器 | N3520 组装机 (N3520 2.166GHz)| 千兆LAN | 4GBRAM / mixed | 2016 |
| 代码仓库 | ONDA v939 Core M | 4G / 2G WIFI | 4GBRAM / 128GB | 2016 |

- [1] Mid 2015, i7 2.2GHz 其实还不错，如果主频能高点就好了。
- [2] Mid 2014, i7 2.5GHz 已经碾压了三家公司(淘宝／美团／阿里云)配的笔记本了, Orz。
- [3] i7 2.6GHz, 配合`hotkey`软件调节节能模式，性能表现极好。
- [4] N3700 1.6GHz

> 🚚 储存资源
> 用来持久化保存资料

| 资源类型 | 明细 | 网络 | 储存 | 开始服务 |
| --- | --- | --- | --- | --- |
| 主要备份 | WD MY CLOUD 4T | 千兆LAN | 4T HDD | 2015 |
| 辅助备份 | WD MY CLOUD 3T | 千兆LAN | 3T HDD | 2014 |
| 临时储存 | N3520 组装机    | 千兆LAN | todo   | 2016 |
| 长期备份 | Canon G3800 ^1 | 2G WIFI | -      | 2016 |

- [1] 打印不失为一种相对稳定的持久化保存方案。

> 📱 移动设备
> 强依赖无线进行交互的设备

| 资源类型 | 明细 | 网络 | 储存 | 开始服务 |
| --- | --- | --- | --- | --- |
| 平板 | iPad Air2 | 4G / 5G WIFI | 128G (改) | 2015 |
| 平板 | iPad Air2 | 5G WIFI | 32G  | 2013 |
| 爪机 | iP7  | 4G / 5G WIFI | 128G | 2016 |
| 爪机 | iP6p | 4G / 5G WIFI | 64G  | 2014 |
| 爪机 | iPse | 4G / 5G WIFI | 64G  | 2017 |
| 爪机 | iP5s | 4G / 5G WIFI | 忽略 ^1 | 2017 |
| 爪机 | S7E  | 4G / 5G WIFI | 忽略 ^2 | 2016 |
| 游戏机 | PSVx2 | 2G WIFI | 16G / 64G | 2015 / 2016 |
| 游戏机 | 3DSx2 | 2G WIFI | 64G / 64G | 2014 / 2016 |

- [1] 工作备机，数据敏感，无需备份保存数据，放着就好。
- [2] 没有特别需求，不会再入三星的机器了，稍后补充吐槽（关于闪付／更新），目前当NFC充值POS。


> 智能设备
> 所谓智能不过是可编程或者扩展了原有的使用者能力

| 资源类型 | 明细 | 网络 |备注 |
| --- | --- | --- | --- |
| 网络插座  | 控客 x5 ^1 | 2G WIFI | 2015年  |
| 网络摄像头 | 水滴 x1 ^2 | 2G WIFI | 2015年 |

- [1] app真心不是太好用，接口切换状态的时候经常重发。
- [2] 之前用的小米，后来换了360水滴，启动提示略吓人。

> 历史设备
> 断电的设备

| 资源类型 | 明细 | 备注 | 开始服务 |
| --- | --- | --- | --- |
| 路由器 | NETGEAR WNDR4300 ^1 | 全千兆，双频，双128MB，其实蛮靠谱的，入了两台了 | 2014 |
| 工控机 | N270, 945GM x2 ^2 | 双网口x1, 单网口x1 | 2015 |
| 工控机 | ~~D525~~ ^3 | 已送人 | 2016 |
| 工控机 | ~~D425~~ | 已丢弃 | 2015 |

- [1] 用于软路由的AP稳定性特别棒，有NetGear的辐射合格的背书，使用放心。不过芯片比较老了，支持的固件和适合运行的自定义功能有限，故放弃使用。
- [2] N3700 组装机虚拟的NAS代替了工控机作为下载和储存机的作用，故废弃。
- [3] 功能与N3700 组装机重复，不过配个启动U盘，刷个群晖／跑几个简单的docker镜像还不错，20W的功率感觉略鸡肋，7x24跑到是也还好。
- [4] 同上，功率差不多，但是性能差太多，更加鸡肋...

## 需求分析

### 保持工作习惯，保持熟悉感

> 尽可能利用系统优势，但是保证一定的方案可替代性

- 一般事务使用 `Mac OSX`，MBP不更换系统。
- 持续编码使用 `Mac OSX`，MBP系统底层环境尽可能干净。
- 游戏娱乐使用 `iOS`/`Windows`/`游戏机`，获得最广泛的资料参考和软件支持。
- 发布测试集中构建使用虚拟化方案，保证环境独立和结果稳定。

### 跨设备开发的可能性，保持一定的灵活性

- 可以接受牺牲一定的性能，或者在某种场景下不是最优方案，但是要保障灵活性。
- 项目构建发布流程期望通用，且可以方便移植到其他系统的机器上，需要使用虚拟化方式实现。
    - 虚拟化技术方案：虚拟机 && Docker
    - 虚拟化系统选择：非Win和OSX之外，系统基础镜像选择 Ubuntu/CentOS/Alpine

### 娱乐体验相对友好(todo)

- 为了玩使命召唤，使用Z7作为Windows下的娱乐机。
- 高速网络利用： 
  - 两个路由分别接入不同的宽带线路，使用不同的DNS和主机隧道进行网络质量提升，并提供冗余网络保障，并区分插座/摄像头和常规使用的线路，避免线路满载，使用效果不佳。
  - 应用路由和软路由QoS保障内网千兆数据交换流畅。
  - 无线利用，详见 #无线使用#
  - 有线利用，详见 #有线使用#
- 持续集成工具功能需求：
    - 版本控制
    - 代码编译
    - 代码构建
    - 代码同步（自用不一定使用打包分发的方式）
    - 代码测试 & Lint
    - 切换发布版本和环境（灰度）
- 发布流程想折腾的需求：
    - 分离环境
        - 日常（本地+虚拟机）
        - 预发（虚拟机二套环境）
        - 线上（远程VPSx3）
    - 分离代码
        - 服务脚本（偏后）
       - 前端资源
       - 数据层代码（DB）
    - CLI TRIGGER EVENT
- 无缝写码环境 && 无缝测试环境
    - 路由表策略 && DHCP半动态
- 无缝DLNA使用

## 具体实践

- [组件家用迷你服务器](./build-mini-home-server.md)
- [基础网络使用](network.md)
- [远程访问及数据交换](remote.md)
- [无线使用](wifi.md)
- [日志收集和查看](log.md)
- [虚拟机使用](vm.md)
- [有线使用](lan.md)

## 一些观点

- [2016年上半年 自组x86软路由/迷你服务器的一些考虑](./think-about-x86-route-2016.md)


